# 算数ドリルアプリ「MathMaster (仮)」実装計画

## 1. プロジェクト概要
Android端末およびアプリストアでのリリースを想定した、シンプルな算数問題アプリを作成します。
まずはウェブ技術（React + Vite）を用いて開発し、Capacitor等の技術を用いてAndroidアプリとしてビルド可能な構成を目指します。

## 2. 技術スタック
- **Frontend Framework**: React (Vite)
- **Language**: TypeScript
- **Styling**: Chakra UI
- **State Management**: Zustand
- **Persistence**: localStorage (ランキング保存用)
- **Build/Packaging**: Capacitor (Androidアプリ化のため)

## 3. デザイン・UI要件
- **テーマ**: ライトテーマ（明るく清潔感のあるデザイン）
- **言語**: 全て日本語。全ての漢字にフリガナ（ルビ `<ruby>` タグまたは補助テキスト）を振る。
- **レイアウト**: レスポンシブ対応。スマートフォン操作を前提としたUI設計。
- **祝賀演出**: 全問正解時に華やかなアニメーション（紙吹雪など）を表示。

## 4. 機能要件詳細

### 4.1 計算モードと難易度
全5モード、各モードに難易度設定あり。

| モード | 難易度 | ルール詳細 | 補足 |
|:---:|:---:|:---|:---|
| **足し算** | 難しい | 3桁 + 3桁 | 和の最大値は999まで |
| | 普通 | 2桁 + 2桁 = 2桁 | 答えが99以下になる組み合わせ |
| | 簡単 | 1桁 + 1桁 = 2桁もあり | |
| **引き算** | 難しい | 2桁 - 2桁 | 繰り下がりあり。答えは0以上 |
| | 普通 | 2桁 - 2桁 | 繰り下がり**なし**。答えは0以上 |
| | 簡単 | 1桁 - 1桁 | 答えは0以上 |
| **掛け算** | 難しい | 2桁 × 2桁 | 最大 12 × 12 まで |
| | 普通 | 最大 10 × 10 | 九九の範囲 + 10の段 |
| **割り算** | 普通 | 商が1桁の整数 | 余りなし |
| **ランダム** | - | 全モード・全難易度からランダム | 1問ごとに抽選 |

### 4.2 ゲーム進行
1. **メニュー画面**: モード選択 -> 難易度選択（またはランダムスタート）
2. **プレイ画面**:
   - 1セット10問。
   - タイム計測（開始から終了まで）。
   - 問題表示（例: `12 + 34 = ?`）。
   - テンキー入力（0-9, クリア, バックスペース）。
3. **リザルト画面**:
   - かかった時間、正解数、誤答数を表示。
   - 結果一覧表示（10問それぞれの式、回答、正誤、正解）。
   - ランキング登録・表示。

### 4.3 ランキング機能
- **保存場所**: 端末ローカルストレージ (`localStorage`)。
- **順位付けルール**:
   1. 正解数が多い順
   2. （正解数が同じなら）タイムが早い順
   3. （両方同じなら）日付が新しい順
- **表示**: 上位記録を表示（例: Top 5）。

## 5. 実装ステップ (Task List)

### Phase 1: 基盤構築
- [ ] プロジェクトの初期化 (Vite + React + TypeScript)
- [ ] 基本的なディレクトリ構成とCSS変数の定義 (Colors, Typography)
- [ ] 共通コンポーネント作成 (Button, Card, Layout)

### Phase 2: ゲームロジック実装
- [ ] 計算問題生成ロジックの実装（難易度ごとの生成関数）
- [ ] ゲーム状態管理の実装（現在の問題、スコア、タイマー、入力値）

### Phase 3: UI実装
- [ ] タイトル画面・モード選択画面の実装
- [ ] プレイ画面（問題表示 + テンキー）の実装
- [ ] リザルト画面・ランキング表示の実装
- [ ] **[NEW] 結果詳細表示（全問の回答履歴）の実装**
- [ ] 祝賀アニメーションの実装

### Phase 4: 仕上げと調整
- [ ] フリガナ対応の徹底
- [ ] レスポンシブデザインの確認と調整
- [ ] バグ修正とパフォーマンステスト

## 6. ユーザーへの確認事項

- アプリストア公開を見据えてCapacitorの導入を想定していますが、現段階ではWebブラウザでの動作確認を優先します。
